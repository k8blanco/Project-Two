<h3 id="resultstitle">It's a Match!</h3>

<!--Full-Width Carousel w/ Embedded Viewer-->
<div class="resp-container">
    <div class="container">
        <div class="carousel carousel-slider center">
            <div class="carousel-fixed-item center">
                <a class="btn btn-small favBtn">Fav Button</a>
                <!-- <a class="btn btn-small gitBtn" href="https://github.com/k8blanco">GITHUB</a> -->
            </div>
            {{#each booksArray}}
            <div class="row">
                <div class="carousel-item red">
                    <div class="col s6" id="viewerCanvas-{{this.gbISBN}}" data-id="{{this.gbISBN}}" style="width: 300px; height: 500px"></div>
                    <div class="card col s6 push s6" id="details">
                        <p>{{this.gbDetails}}</p>
                    </div>
                </div>
            </div>
            {{/each}}
        </div>
    </div>
</div>



<!-- Begin Favorite Functionality -->

<!--Dynamically Insert New Books to Favorites List -->
{{#each booksArray}}
{{#unless favorited}}
<form action="book/favorite/{{id}}" method="POST">
    <div class="results-list">
        <li class="list-group">{{id}}
            {{this.gbId}}</li>
        <span class="input-group-btn">
            <button class="btn btn-favorite-button" type="submit">Add to Favorites!</button>
        </span>
    </div>
</form>
{{/unless}}
{{/each}}



<!--List-->
{{!-- <div class="container">
    <div class="card">
        <ul id="results-list" class="list-group">
            {{#each booksArray}}
            <li data-id="{{this.gbId}}" class="list-group-item">
                <span>{{this.gbInfo.title}}</span>
                <button class="btn">Heart!</button>
            </li>
            {{/each}}
        </ul>
    </div>
</div> --}}



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script type="text/javascript" src="https://www.google.com/books/jsapi.js"></script>
<script src="/js/index.js"></script>

<script>

    //carousel scripts
    $(document).ready(function () {
        $(".carousel").carousel();

        $(".carousel.carousel-slider").carousel({
            fullWidth: true,
            indicators: true,

            //onCycleTo function - assign author/title data to fav button on click, depending on what slide
         
            onCycleTo: function (ele) {
            //console log entire element and index of element
            console.log(ele)
            console.log($(ele).index());
            }
            //console.log($(ele).index());
            //assign favLink
            //favLink = $("#" + ele.id).attr("href");
            //console.log("element id: ", ele.id);
            //$(".favBtn").attr("href", favLink);
            //console.log("demo link: ", favLink);
            //};

        });

        //getting a reference to the favorites button where user adds a new fav
        //var $newFavInput = $("input.new-item")
        //our new fav will go inside favContainer
        //var $favContainer = $(".fav-container");

        //event listener for adding fav
        //$(document).on("click", ".favBtn", insertFav)

      

      
     

    
    });

    //$(".favBtn").on("click", function () {
    //$.post("/book/favorite",
    //{ title: "titletest",author: "authortest"}),
    //function (data, status) {
    //alert("data: ", data)}
    //console.log("you clicked me!");});



    //embedded viewer scripts
    google.books.load();
    google.books.setOnLoadCallback(initializeViewers);

    //initialize Google View for each book
    function initializeViewers() {

        //loop through each viewer canvas - anything w/ an id starting with "viewerCanvas"
        $("[id^=viewerCanvas]").each(function () {
            //Create a new viewer for each of them
            let isbn = $(this).data("id");
            console.log(isbn);

            //console.log("this: ", $(this));
            //console.log($(this).attr("id"));
            //console.log(this.id);

            //!-- let viewerCanvasDomElemId = "viewerCanvas-" + isbn;
            let googleViewer = new google.books.DefaultViewer(this);

            //Load the viewer for each book using it's ISBN
            googleViewer.load("ISBN:" + isbn, null);
        })
    }


    function alertInitialized() {
        alert("book successfully loaded and initialized!");
    }

    function alertNotFound() {
        alert("could not embed the book!");
    }


</script>